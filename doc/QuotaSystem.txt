
The quota system
----------------

The quota system works with OpenSER data sources. It enforces usage limits
for post-paid accounts. 

The quota system builds incremental statistics with usage information from
the normalized SIP sessions, it compares the curent usage with the monthly
quota assigned by administrator and blocks the accounts in the SIP Proxy
when the quota is exceeded. 

The system will not stop in real-time ongoing calls but provides in practice
a practical protection against fraudulent usage of the platform.

The quota is checked by a cron job:

/var/www/CDRTool/scripts/SER/quotaCheck.php

At the beginning of each calendar month the quota usage is reset and all
users are unblocked:

/var/www/CDRTool/scripts/SER/quotaReset.php

The current quota usage can be monitored in Rating -> Quota usage web page.

When quota is exceeded, an email notification is sent to the user and a copy
of the message to the platform administrator. To customize the email message
subject, body and other header fields you must create some entries in
cdrtool.settings table. See CDRTool/setup/mysql/custom_notifications.mysql
for an example.

